<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx"
               minWidth="955"
               minHeight="600">
    <fx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;
            import mx.rpc.events.FaultEvent;
            import mx.rpc.events.ResultEvent;
            import mx.utils.ArrayUtil;
            import mx.utils.ObjectUtil;
            import mx.utils.StringUtil;
            
            import org.as3commons.lang.HashArray;
            import org.as3commons.lang.StringUtils;
            
            import pkg.User;
            
            [bindable] private var protocol:String = "http";
            [bindable] private var server:String = "localhost";
            [bindable] private var port:String = "8080";
            [bindable] private var context:String = "java-amf";
            [bindable] private var endPoint:String=protocol+ "://" + server + ":" + port + "/" + context + "/messagebroker/amf"; 
            
            [Bindable] private var destination:String="UserService";
            [Bindable] private var source:String="UserService";
            
            protected function resultHandler(event:ResultEvent):void
            {
                txtId.text =event.result.toString();
                if (event.result is User) {
                    txtId.text =ObjectUtil.toString(event.result as User);
                } else {
                    txtId.text =event.result.toString();
                }
            }
            
            protected function faulHandler(event:FaultEvent):void
            {
                txtId.text=event.message.toString();
            }
            
            protected function callAmfString(event:MouseEvent):void
            {
                remoteService.endpoint = endPoint;
                remoteService.sayHello();
            }
            
            protected function callAmfObject(event:MouseEvent):void
            {
                remoteService.endpoint = endPoint;
                remoteService.getById();
            }
        
        ]]>
    </fx:Script>
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
        <s:RemoteObject id="remoteService" destination="{destination}" endpoint="{endPoint}" source="{source}" showBusyCursor="true">
            <s:method name="sayHello" result="resultHandler(event)" fault="faulHandler(event)"></s:method>
            <s:method name="getById" result="resultHandler(event)" fault="faulHandler(event)"></s:method>
        </s:RemoteObject>
    </fx:Declarations>
    <mx:VBox>
        <s:TextArea id="txtId" width="200" height="200"/> 
        <s:Button label="Call String AMF" click="callAmfString(event)"/>
        <s:Button label="Call User AMF" click="callAmfObject(event)"/>
    </mx:VBox>
</s:Application>
